---
title: 箭头函数
date: 2020-07-25 15:22:25
tags:
    - javascript
    - es6
categories:
    - javascript
    - es6
---

## 箭头函数

### 基本用法

ES6 中 允许使用 “箭头”(=>) 定义函数。

```javascript
var f = v => v

// 等同于
var f = function (v) {
	return v
}
```

无参或者多个参数，使用一个圆括号代表参数部分。

```javascript
var f = () => 5
// 等同于
var f = function () { return 5 }

var sum = (num1, num2) => num1 + num2
// 等同于
var sum = function (num1, num2) {
	return num1 + num2
}
```

如果箭头函数的代码块只有一行代码，可以省略大括号以及return，
如果代码块多于一行则需要使用大括号，并且使用return语句返回。

```javascript
var sum = (num1, num2) => { return num1 + num2 }
```

因为大括号内为代码块，如果箭头函数直接返回一个对象，必须在对象外面加上括号，否则会报错。

```javascript
// 报错
var getTempItem = id => { id: id, name: "Temp" }

// 不报错
var getTempItem = id => ({ id: id, name: "Temp" })
```

### 注意点

1. 函数体内的 `this` 对象，就是定义时所在的对象，而不是使用时所在的对象。(往外寻找this)
2. 不可以当作构造函数，也就是说，不可以使用 `new` 命令，否则会抛出一个错误。
3. 不可以使用 `arguments` 对象，该对象在函数体内不存在。如果要用，可以用 rest 参数代替。
4. 不可以使用 `yield` 命令，因此箭头函数不能用作 Generator 函数。

上面四点中，第一点尤其值得注意。this对象的指向是可变的，但是在箭头函数中，它是固定的。

```javascript
function foo() {
  setTimeout(() => {
    console.log('id:', this.id);
  }, 100);
}

var id = 21;

foo.call({ id: 42 });
// id: 42
```

上面代码中，`setTimeout` 的参数是一个箭头函数，这个箭头函数的定义生效是在 `foo` 函数生成时，而它的真正执行要等到 100 毫秒后。如果是普通函数，执行时 `this` 应该指向全局对象 `window` ，这时应该输出 `21`。但是，箭头函数导致`this`总是指向函数定义生效时所在的对象（本例是`{id: 42}`），所以输出的是`42`。

#### 更多详细内容

[阮一峰-ES6-函数的拓展-箭头函数](https://es6.ruanyifeng.com/#docs/function#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0 "阮一峰-ES6-函数的拓展-箭头函数")
